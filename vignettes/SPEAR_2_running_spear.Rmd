---
title: "SPEAR: Using the new version"
author: "Jeremy Gygi"
date: "06/28/21"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{SPEAR_2-running_SPEAR}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

### This vignette will provide a walkthrough for using the new version of SPEAR on multi-omic data.

##### Installing SPEAR:

Follow installation instructions in README (located [here](https://github.com/jgygi/SPEAR))

##### Required Libraries:

```{r message = FALSE, warning = FALSE}
library(SPEAR)
```

### Loading the multi-omic data:

Loading your own multi-omic data:

```{r}
# Parameters:
# X - a list of matrices of omics data [subjects = rows, features = columns] (i.e. OmicsData 1 would be X[[1]], ...)
# Y - a matrix of response data [subjects = rows, response.variables = columns] (i.e. Response1 would be Y[,1], ...)
# 
# Data should be scaled/standardized (mean = 0, variance = 1) before using SPEAR:

X <- NULL # Replace with your list of matrices...
Y <- NULL # Replace with your matrix...
```

Read in simulated data...

```{r}
# Generated from the SPEAR_simulate_data.Rmd file:
path_to_sim_data <- ""
sim.data <- readRDS(paste0(path_to_sim_data, "simulated_gaussian_data.rds"))

X <- sim.data$data.tr$xlist
Y <- sim.data$data.tr$Y
```

Naming the features, subjects, and datasets (for downstream analysis):

```{r}
colnames(Y) <- "GausResponse"
rownames(Y) <- paste0("Subject", 1:nrow(Y))
names(X) <- paste0("OmicsData", 1:length(X))
for(i in 1:length(X)){
  colnames(X[[i]]) <- paste0(names(X)[i], "_feat", 1:ncol(X[[i]]))
  rownames(X[[i]]) <- paste0("Subject", 1:nrow(X[[i]]))
}
```

# Getting SPEAR to run:

## 1) Make a SPEARobject-class object:

```{r}
SPEARobj <- make.SPEARobject(X = X,
                             Y = Y,
                             family = "gaussian",
                             seed = 456)
# NOTE: you can use encoded family parameters as well (i.e. family = 0 for gaussian, 1 for binomial,
#                                                      2 for ordinal and 3 for multinomial)
```

When you initialize a SPEARobject, the `$fit` list will be `NULL`...

```{r}
names(SPEARobj$fit)
```

## 2) Running regular SPEAR (no cross validation):

```{r}
SPEARobj$run.spear()
```

This will populate the `$fit` parameter:

```{r}
names(SPEARobj$fit)
```

## 3) Running cross validation SPEAR:
```{r}
SPEARobj$run.cv.spear()
```

